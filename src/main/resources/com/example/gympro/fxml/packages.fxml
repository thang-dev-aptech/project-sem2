<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.geometry.Insets?>
<?import java.lang.String?>

<!--
  UPDATED:
  1. Changed SplitPane to vertical orientation (orientation="VERTICAL").
  2. Layout will be Top Row (Table) and Bottom Row (Details).
  3. Removed minWidths, added minHeight (optional) to ensure content display.
-->

<ScrollPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.example.gympro.controller.PackagesController"
            stylesheets="@../css/styles.css" fitToWidth="true" styleClass="dashboard-scroll">

    <VBox spacing="20" styleClass="dashboard-container">
        <padding>
            <Insets top="30" left="30" right="30" bottom="10"/>
        </padding>

        <!-- HEADER -->
        <VBox spacing="5">
            <Label text="Package Management" styleClass="page-title"/>
            <Label text="Create and manage membership packages." styleClass="page-subtitle"/>
        </VBox>

        <!-- TOOLBAR -->
        <ToolBar styleClass="tool-bar">
            <items>
                <TextField promptText="ðŸ” Search packages..." fx:id="searchField" prefWidth="250" onKeyReleased="#handleFilter"/>
                <ComboBox fx:id="statusFilter" promptText="ðŸ“Š Status" prefWidth="120"/>
                <Separator orientation="VERTICAL"/>
                <Button text="âž• Add Package" styleClass="icon-button, success" onAction="#handleNewPackage"/>
                <Button text="ðŸ”„ Refresh" styleClass="icon-button" onAction="#loadPackages"/>
                <Button fx:id="exportButton" text="ðŸ“¤ Export Excel" styleClass="icon-button" onAction="#handleExportExcel"/>
            </items>
        </ToolBar>

        <!--
          SPLIT PANE (VERTICAL)
          - orientation="VERTICAL"
          - dividerPositions="0.60" (60% for top row, 40% for bottom row)
        -->
        <SplitPane VBox.vgrow="ALWAYS" dividerPositions="0.45" orientation="VERTICAL" styleClass="main-split-pane">

            <!-- ROW 1: TABLE VIEW (Package List) -->
            <VBox spacing="10" styleClass="card, table-view-container" minHeight="400">
                <Label text="Package List" styleClass="card-title"/>
                <TableView fx:id="packagesTable" VBox.vgrow="ALWAYS">
                    <columns>
                        <TableColumn text="Code" prefWidth="100" fx:id="colCode"/>
                        <TableColumn text="Package Name" prefWidth="150" fx:id="colName"/>
                        <TableColumn text="Duration" prefWidth="80" fx:id="colDuration"/>
                        <TableColumn text="Price" prefWidth="120" fx:id="colPrice"/>
                        <TableColumn text="Status" prefWidth="100" fx:id="colStatus"/>
                        <TableColumn text="Description" prefWidth="200" fx:id="colDescription"/>
                        <TableColumn text="Created At" prefWidth="150" fx:id="colCreatedAt"/>
                        <TableColumn text="Updated At" prefWidth="150" fx:id="colUpdatedAt"/>
                        <TableColumn text=" " prefWidth="78" fx:id="colActions"/>
                    </columns>
                </TableView>
            </VBox>

            <!-- ROW 2: DETAIL FORM (VBox Layout) -->
            <VBox fx:id="detailPane" spacing="15" styleClass="card" minHeight="300">
                <padding>
                    <Insets top="20" right="20" bottom="20" left="20"/>
                </padding>

                <Label fx:id="formTitle" text="Package Details" styleClass="card-title"/>
                <Separator styleClass="form-separator"/>

                <!-- FORM INPUTS (GridPane) -->
                <GridPane hgap="10" vgap="10">
                    <columnConstraints>
                        <!-- Divide into 4 columns for horizontal form -->
                        <ColumnConstraints percentWidth="15"/>
                        <ColumnConstraints percentWidth="35"/>
                        <ColumnConstraints percentWidth="15"/>
                        <ColumnConstraints percentWidth="35"/>
                    </columnConstraints>

                    <!-- Column 1 -->
                    <Label text="Code:" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                    <TextField fx:id="codeField" promptText="e.g: PLAN-001" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                    <Label text="Package Name:" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                    <TextField fx:id="nameField" promptText="1 Month Package" GridPane.columnIndex="1" GridPane.rowIndex="1"/>

                    <Label text="Status:" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                    <HBox spacing="10" GridPane.columnIndex="1" GridPane.rowIndex="2">
                        <CheckBox fx:id="isActiveCheckbox" text="ðŸŸ¢ Active"/>
                    </HBox>

                    <!-- Column 2 -->
                    <Label text="Price (VND):" GridPane.columnIndex="2" GridPane.rowIndex="0"/>
                    <TextField fx:id="priceField" promptText="500000" GridPane.columnIndex="3" GridPane.rowIndex="0"/>

                    <Label text="Duration (Days):" GridPane.columnIndex="2" GridPane.rowIndex="1"/>
                    <TextField fx:id="durationField" promptText="30" GridPane.columnIndex="3" GridPane.rowIndex="1"/>

                    <!-- Description spans all 4 columns -->
                    <Label text="Description:" GridPane.columnIndex="0" GridPane.rowIndex="3"/>
                    <TextArea fx:id="descriptionArea" wrapText="true" prefHeight="80"
                              GridPane.columnIndex="1" GridPane.rowIndex="3"
                              GridPane.columnSpan="3"/>
                </GridPane>

                <!--
                  UPDATED: Added VBox.margin with negative top margin to reduce spacing
                -->
                <HBox spacing="10" alignment="CENTER_RIGHT" styleClass="button-group">
                    <Button fx:id="deleteButton" text="Delete" styleClass="delete-button" onAction="#handleDelete"/>
                    <Button text="Cancel" styleClass="secondary-button" onAction="#handleCancel"/>
                    <Button fx:id="saveButton" text="Save" styleClass="primary-button" onAction="#handleSave"/>
                </HBox>
            </VBox>
        </SplitPane>
    </VBox>
</ScrollPane>

