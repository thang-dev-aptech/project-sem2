<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.geometry.Insets?>

<ScrollPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" 
            fx:controller="com.example.gympro.controller.ReportsController" 
            stylesheets="@../css/styles.css" 
            fitToWidth="true" 
            styleClass="dashboard-scroll">
    <VBox spacing="20" styleClass="dashboard-container">
        <padding>
            <Insets top="30" left="30" right="30" bottom="30"/>
        </padding>

        <!-- Header -->
        <VBox spacing="5">
            <Label text="ðŸ“Š BÃ¡o CÃ¡o Chi Tiáº¿t" styleClass="page-title"/>
            <Label text="Xem vÃ  xuáº¥t bÃ¡o cÃ¡o theo khoáº£ng thá»i gian" styleClass="page-subtitle"/>
        </VBox>

        <!-- Date Range Filter -->
        <HBox spacing="15" alignment="CENTER_LEFT" styleClass="card" style="-fx-padding: 15;">
            <Label text="ðŸ“… Khoáº£ng thá»i gian:" style="-fx-font-weight: bold;"/>
            <DatePicker fx:id="dateFrom" promptText="Tá»« ngÃ y"/>
            <Label text="â†’"/>
            <DatePicker fx:id="dateTo" promptText="Äáº¿n ngÃ y"/>
            <Button fx:id="btnFilter" text="ðŸ” Lá»c" style="-fx-background-color: #2196F3; -fx-text-fill: white;"/>
            <Button fx:id="btnReset" text="ðŸ”„ Äáº·t láº¡i" style="-fx-background-color: #757575; -fx-text-fill: white;"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Label fx:id="lblSummary" text="" style="-fx-font-weight: bold; -fx-text-fill: #4CAF50;"/>
        </HBox>

        <!-- TabPane for different report types -->
        <TabPane fx:id="tabPane" tabClosingPolicy="UNAVAILABLE">
            
            <!-- Tab 1: Revenue Report -->
            <Tab text="ðŸ’° Doanh Thu" closable="false">
                <VBox spacing="15" style="-fx-padding: 15;">
                    <HBox spacing="10" alignment="CENTER_RIGHT">
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button fx:id="btnExportRevenue" text="ðŸ“¤ Xuáº¥t Excel" 
                                style="-fx-background-color: #4CAF50; -fx-text-fill: white;"/>
                    </HBox>
                    
                    <!-- Revenue Summary Cards -->
                    <GridPane hgap="15" vgap="15">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="25" minWidth="200"/>
                            <ColumnConstraints percentWidth="25" minWidth="200"/>
                            <ColumnConstraints percentWidth="25" minWidth="200"/>
                            <ColumnConstraints percentWidth="25" minWidth="200"/>
                        </columnConstraints>
                        
                        <VBox styleClass="card" spacing="5" style="-fx-padding: 15;" GridPane.columnIndex="0">
                            <Label text="Tá»•ng doanh thu" style="-fx-font-size: 12; -fx-text-fill: #757575;"/>
                            <Label fx:id="lblTotalRevenue" text="0 VNÄ" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #4CAF50;"/>
                        </VBox>
                        
                        <VBox styleClass="card" spacing="5" style="-fx-padding: 15;" GridPane.columnIndex="1">
                            <Label text="Sá»‘ hÃ³a Ä‘Æ¡n" style="-fx-font-size: 12; -fx-text-fill: #757575;"/>
                            <Label fx:id="lblTotalInvoices" text="0" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #2196F3;"/>
                        </VBox>
                        
                        <VBox styleClass="card" spacing="5" style="-fx-padding: 15;" GridPane.columnIndex="2">
                            <Label text="Sá»‘ thanh toÃ¡n" style="-fx-font-size: 12; -fx-text-fill: #757575;"/>
                            <Label fx:id="lblTotalPayments" text="0" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #FF9800;"/>
                        </VBox>
                        
                        <VBox styleClass="card" spacing="5" style="-fx-padding: 15;" GridPane.columnIndex="3">
                            <Label text="Trung bÃ¬nh/HÄ" style="-fx-font-size: 12; -fx-text-fill: #757575;"/>
                            <Label fx:id="lblAvgInvoice" text="0 VNÄ" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #9C27B0;"/>
                        </VBox>
                    </GridPane>

                    <!-- Revenue Details Table -->
                    <TableView fx:id="tblRevenue" prefHeight="400">
                        <columns>
                            <TableColumn fx:id="colInvoiceNo" text="Sá»‘ HÄ" prefWidth="100"/>
                            <TableColumn fx:id="colInvoiceDate" text="NgÃ y" prefWidth="120"/>
                            <TableColumn fx:id="colMemberName" text="Há»™i viÃªn" prefWidth="150"/>
                            <TableColumn fx:id="colMemberCode" text="MÃ£ HV" prefWidth="100"/>
                            <TableColumn fx:id="colPackageName" text="GÃ³i táº­p" prefWidth="120"/>
                            <TableColumn fx:id="colSubtotal" text="Táº¡m tÃ­nh" prefWidth="120"/>
                            <TableColumn fx:id="colDiscount" text="Giáº£m giÃ¡" prefWidth="100"/>
                            <TableColumn fx:id="colTotal" text="Tá»•ng cá»™ng" prefWidth="120"/>
                            <TableColumn fx:id="colStatus" text="Tráº¡ng thÃ¡i" prefWidth="100"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>

            <!-- Tab 2: Member Report -->
            <Tab text="ðŸ‘¥ Há»™i ViÃªn" closable="false">
                <VBox spacing="15" style="-fx-padding: 15;">
                    <HBox spacing="10" alignment="CENTER_RIGHT">
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button fx:id="btnExportMembers" text="ðŸ“¤ Xuáº¥t Excel" 
                                style="-fx-background-color: #4CAF50; -fx-text-fill: white;"/>
                    </HBox>
                    
                    <!-- Member Summary -->
                    <GridPane hgap="15" vgap="15">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="25" minWidth="200"/>
                            <ColumnConstraints percentWidth="25" minWidth="200"/>
                            <ColumnConstraints percentWidth="25" minWidth="200"/>
                            <ColumnConstraints percentWidth="25" minWidth="200"/>
                        </columnConstraints>
                        
                        <VBox styleClass="card" spacing="5" style="-fx-padding: 15;" GridPane.columnIndex="0">
                            <Label text="Tá»•ng há»™i viÃªn" style="-fx-font-size: 12; -fx-text-fill: #757575;"/>
                            <Label fx:id="lblTotalMembers" text="0" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #4CAF50;"/>
                        </VBox>
                        
                        <VBox styleClass="card" spacing="5" style="-fx-padding: 15;" GridPane.columnIndex="1">
                            <Label text="Há»™i viÃªn má»›i" style="-fx-font-size: 12; -fx-text-fill: #757575;"/>
                            <Label fx:id="lblNewMembers" text="0" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #2196F3;"/>
                        </VBox>
                        
                        <VBox styleClass="card" spacing="5" style="-fx-padding: 15;" GridPane.columnIndex="2">
                            <Label text="Äang hoáº¡t Ä‘á»™ng" style="-fx-font-size: 12; -fx-text-fill: #757575;"/>
                            <Label fx:id="lblActiveMembers" text="0" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #FF9800;"/>
                        </VBox>
                        
                        <VBox styleClass="card" spacing="5" style="-fx-padding: 15;" GridPane.columnIndex="3">
                            <Label text="Háº¿t háº¡n" style="-fx-font-size: 12; -fx-text-fill: #757575;"/>
                            <Label fx:id="lblExpiredMembers" text="0" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #F44336;"/>
                        </VBox>
                    </GridPane>

                    <!-- Member Details Table -->
                    <TableView fx:id="tblMembers" prefHeight="400">
                        <columns>
                            <TableColumn fx:id="colMemberCode2" text="MÃ£ HV" prefWidth="100"/>
                            <TableColumn fx:id="colMemberName2" text="Há» tÃªn" prefWidth="150"/>
                            <TableColumn fx:id="colMemberPhone2" text="SÄT" prefWidth="120"/>
                            <TableColumn fx:id="colMemberEmail2" text="Email" prefWidth="150"/>
                            <TableColumn fx:id="colMemberStatus2" text="Tráº¡ng thÃ¡i" prefWidth="100"/>
                            <TableColumn fx:id="colMemberPackage2" text="GÃ³i hiá»‡n táº¡i" prefWidth="120"/>
                            <TableColumn fx:id="colMemberStartDate" text="NgÃ y báº¯t Ä‘áº§u" prefWidth="120"/>
                            <TableColumn fx:id="colMemberEndDate" text="NgÃ y káº¿t thÃºc" prefWidth="120"/>
                            <TableColumn fx:id="colMemberCreated" text="NgÃ y táº¡o" prefWidth="120"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>

            <!-- Tab 3: Package Report -->
            <Tab text="ðŸ“¦ GÃ³i Táº­p" closable="false">
                <VBox spacing="15" style="-fx-padding: 15;">
                    <HBox spacing="10" alignment="CENTER_RIGHT">
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button fx:id="btnExportPackages" text="ðŸ“¤ Xuáº¥t Excel" 
                                style="-fx-background-color: #4CAF50; -fx-text-fill: white;"/>
                    </HBox>

                    <!-- Package Sales Table -->
                    <TableView fx:id="tblPackages" prefHeight="500">
                        <columns>
                            <TableColumn fx:id="colPackageName2" text="TÃªn gÃ³i" prefWidth="150"/>
                            <TableColumn fx:id="colPackagePrice" text="GiÃ¡" prefWidth="120"/>
                            <TableColumn fx:id="colPackageSold" text="Sá»‘ lÆ°á»£ng bÃ¡n" prefWidth="120"/>
                            <TableColumn fx:id="colPackageRevenue" text="Doanh thu" prefWidth="150"/>
                            <TableColumn fx:id="colPackageAvg" text="TB/HÄ" prefWidth="120"/>
                            <TableColumn fx:id="colPackageStatus" text="Tráº¡ng thÃ¡i" prefWidth="100"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>

            <!-- Tab 4: Payment Report -->
            <Tab text="ðŸ’³ Thanh ToÃ¡n" closable="false">
                <VBox spacing="15" style="-fx-padding: 15;">
                    <HBox spacing="10" alignment="CENTER_RIGHT">
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button fx:id="btnExportPayments" text="ðŸ“¤ Xuáº¥t Excel" 
                                style="-fx-background-color: #4CAF50; -fx-text-fill: white;"/>
                    </HBox>

                    <!-- Payment Summary -->
                    <GridPane hgap="15" vgap="15">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="33" minWidth="200"/>
                            <ColumnConstraints percentWidth="33" minWidth="200"/>
                            <ColumnConstraints percentWidth="34" minWidth="200"/>
                        </columnConstraints>
                        
                        <VBox styleClass="card" spacing="5" style="-fx-padding: 15;" GridPane.columnIndex="0">
                            <Label text="Tiá»n máº·t" style="-fx-font-size: 12; -fx-text-fill: #757575;"/>
                            <Label fx:id="lblCashTotal" text="0 VNÄ" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #4CAF50;"/>
                        </VBox>
                        
                        <VBox styleClass="card" spacing="5" style="-fx-padding: 15;" GridPane.columnIndex="1">
                            <Label text="Chuyá»ƒn khoáº£n" style="-fx-font-size: 12; -fx-text-fill: #757575;"/>
                            <Label fx:id="lblBankTotal" text="0 VNÄ" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #2196F3;"/>
                        </VBox>
                        
                        <VBox styleClass="card" spacing="5" style="-fx-padding: 15;" GridPane.columnIndex="2">
                            <Label text="QR Code" style="-fx-font-size: 12; -fx-text-fill: #757575;"/>
                            <Label fx:id="lblQRTotal" text="0 VNÄ" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #FF9800;"/>
                        </VBox>
                    </GridPane>

                    <!-- Payment Details Table -->
                    <TableView fx:id="tblPayments" prefHeight="400">
                        <columns>
                            <TableColumn fx:id="colPaymentId" text="MÃ£ TT" prefWidth="100"/>
                            <TableColumn fx:id="colPaymentDate" text="NgÃ y TT" prefWidth="120"/>
                            <TableColumn fx:id="colPaymentInvoice" text="Sá»‘ HÄ" prefWidth="100"/>
                            <TableColumn fx:id="colPaymentMember" text="Há»™i viÃªn" prefWidth="150"/>
                            <TableColumn fx:id="colPaymentAmount" text="Sá»‘ tiá»n" prefWidth="120"/>
                            <TableColumn fx:id="colPaymentMethod" text="PhÆ°Æ¡ng thá»©c" prefWidth="120"/>
                            <TableColumn fx:id="colPaymentNote" text="Ghi chÃº" prefWidth="200"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>

        </TabPane>

    </VBox>
</ScrollPane>
