<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.geometry.Insets?>

<ScrollPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" 
            fx:controller="com.example.gympro.controller.ReportsController" 
            stylesheets="@../css/styles.css" 
            fitToWidth="true" 
            styleClass="dashboard-scroll">
    <VBox spacing="20" styleClass="dashboard-container">
        <padding>
            <Insets top="30" left="30" right="30" bottom="30"/>
        </padding>

        <!-- Header -->
        <VBox spacing="5">
            <Label text="ðŸ“Š Detailed Reports" styleClass="page-title"/>
            <Label text="View and export reports by date range" styleClass="page-subtitle"/>
        </VBox>

        <!-- Date Range Filter -->
        <HBox spacing="15" alignment="CENTER_LEFT" styleClass="card" style="-fx-padding: 15;">
            <Label text="ðŸ“… Date Range:" style="-fx-font-weight: bold;"/>
            <DatePicker fx:id="dateFrom" promptText="From Date"/>
            <Label text="â†’"/>
            <DatePicker fx:id="dateTo" promptText="To Date"/>
            <Button fx:id="btnFilter" text="ðŸ” Filter" style="-fx-background-color: #2196F3; -fx-text-fill: white;"/>
            <Button fx:id="btnReset" text="ðŸ”„ Reset" style="-fx-background-color: #757575; -fx-text-fill: white;"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Label fx:id="lblSummary" text="" style="-fx-font-weight: bold; -fx-text-fill: #4CAF50;"/>
        </HBox>

        <!-- TabPane for different report types -->
        <TabPane fx:id="tabPane" tabClosingPolicy="UNAVAILABLE">
            
            <!-- Tab 1: Revenue Report -->
            <Tab text="ðŸ’° Revenue" closable="false">
                <VBox spacing="15" style="-fx-padding: 15;">
                    <HBox spacing="10" alignment="CENTER_RIGHT">
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button fx:id="btnExportRevenue" text="ðŸ“¤ Export Excel" 
                                style="-fx-background-color: #4CAF50; -fx-text-fill: white;"/>
                    </HBox>
                    
                    <!-- Revenue Summary Cards -->
                    <GridPane hgap="15" vgap="15">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="25" minWidth="200"/>
                            <ColumnConstraints percentWidth="25" minWidth="200"/>
                            <ColumnConstraints percentWidth="25" minWidth="200"/>
                            <ColumnConstraints percentWidth="25" minWidth="200"/>
                        </columnConstraints>
                        
                        <VBox styleClass="card" spacing="5" style="-fx-padding: 15;" GridPane.columnIndex="0">
                            <Label text="Total Revenue" style="-fx-font-size: 12; -fx-text-fill: #757575;"/>
                            <Label fx:id="lblTotalRevenue" text="0 VND" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #4CAF50;"/>
                        </VBox>
                        
                        <VBox styleClass="card" spacing="5" style="-fx-padding: 15;" GridPane.columnIndex="1">
                            <Label text="Total Invoices" style="-fx-font-size: 12; -fx-text-fill: #757575;"/>
                            <Label fx:id="lblTotalInvoices" text="0" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #2196F3;"/>
                        </VBox>
                        
                        <VBox styleClass="card" spacing="5" style="-fx-padding: 15;" GridPane.columnIndex="2">
                            <Label text="Total Payments" style="-fx-font-size: 12; -fx-text-fill: #757575;"/>
                            <Label fx:id="lblTotalPayments" text="0" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #FF9800;"/>
                        </VBox>
                        
                        <VBox styleClass="card" spacing="5" style="-fx-padding: 15;" GridPane.columnIndex="3">
                            <Label text="Avg/Invoice" style="-fx-font-size: 12; -fx-text-fill: #757575;"/>
                            <Label fx:id="lblAvgInvoice" text="0 VND" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #9C27B0;"/>
                        </VBox>
                    </GridPane>

                    <!-- Revenue Details Table -->
                    <TableView fx:id="tblRevenue" prefHeight="400">
                        <columns>
                            <TableColumn fx:id="colInvoiceNo" text="Invoice #" prefWidth="100"/>
                            <TableColumn fx:id="colInvoiceDate" text="Date" prefWidth="120"/>
                            <TableColumn fx:id="colMemberName" text="Member" prefWidth="150"/>
                            <TableColumn fx:id="colMemberCode" text="Member Code" prefWidth="100"/>
                            <TableColumn fx:id="colPackageName" text="Package" prefWidth="120"/>
                            <TableColumn fx:id="colSubtotal" text="Subtotal" prefWidth="120"/>
                            <TableColumn fx:id="colTotal" text="Total" prefWidth="120"/>
                            <TableColumn fx:id="colStatus" text="Status" prefWidth="100"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>

            <!-- Tab 2: Member Report -->
            <Tab text="ðŸ‘¥ Members" closable="false">
                <VBox spacing="15" style="-fx-padding: 15;">
                    <HBox spacing="10" alignment="CENTER_RIGHT">
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button fx:id="btnExportMembers" text="ðŸ“¤ Export Excel" 
                                style="-fx-background-color: #4CAF50; -fx-text-fill: white;"/>
                    </HBox>
                    
                    <!-- Member Summary -->
                    <GridPane hgap="15" vgap="15">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="25" minWidth="200"/>
                            <ColumnConstraints percentWidth="25" minWidth="200"/>
                            <ColumnConstraints percentWidth="25" minWidth="200"/>
                            <ColumnConstraints percentWidth="25" minWidth="200"/>
                        </columnConstraints>
                        
                        <VBox styleClass="card" spacing="5" style="-fx-padding: 15;" GridPane.columnIndex="0">
                            <Label text="Total Members" style="-fx-font-size: 12; -fx-text-fill: #757575;"/>
                            <Label fx:id="lblTotalMembers" text="0" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #4CAF50;"/>
                        </VBox>
                        
                        <VBox styleClass="card" spacing="5" style="-fx-padding: 15;" GridPane.columnIndex="1">
                            <Label text="New Members" style="-fx-font-size: 12; -fx-text-fill: #757575;"/>
                            <Label fx:id="lblNewMembers" text="0" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #2196F3;"/>
                        </VBox>
                        
                        <VBox styleClass="card" spacing="5" style="-fx-padding: 15;" GridPane.columnIndex="2">
                            <Label text="Active Members" style="-fx-font-size: 12; -fx-text-fill: #757575;"/>
                            <Label fx:id="lblActiveMembers" text="0" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #FF9800;"/>
                        </VBox>
                        
                        <VBox styleClass="card" spacing="5" style="-fx-padding: 15;" GridPane.columnIndex="3">
                            <Label text="Expired Members" style="-fx-font-size: 12; -fx-text-fill: #757575;"/>
                            <Label fx:id="lblExpiredMembers" text="0" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #F44336;"/>
                        </VBox>
                    </GridPane>

                    <!-- Member Details Table -->
                    <TableView fx:id="tblMembers" prefHeight="400">
                        <columns>
                            <TableColumn fx:id="colMemberCode2" text="Member Code" prefWidth="100"/>
                            <TableColumn fx:id="colMemberName2" text="Full Name" prefWidth="150"/>
                            <TableColumn fx:id="colMemberPhone2" text="Phone" prefWidth="120"/>
                            <TableColumn fx:id="colMemberEmail2" text="Email" prefWidth="150"/>
                            <TableColumn fx:id="colMemberStatus2" text="Status" prefWidth="100"/>
                            <TableColumn fx:id="colMemberPackage2" text="Current Package" prefWidth="120"/>
                            <TableColumn fx:id="colMemberStartDate" text="Start Date" prefWidth="120"/>
                            <TableColumn fx:id="colMemberEndDate" text="End Date" prefWidth="120"/>
                            <TableColumn fx:id="colMemberCreated" text="Created Date" prefWidth="120"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>

            <!-- Tab 3: Package Report -->
            <Tab text="ðŸ“¦ Packages" closable="false">
                <VBox spacing="15" style="-fx-padding: 15;">
                    <HBox spacing="10" alignment="CENTER_RIGHT">
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button fx:id="btnExportPackages" text="ðŸ“¤ Export Excel" 
                                style="-fx-background-color: #4CAF50; -fx-text-fill: white;"/>
                    </HBox>

                    <!-- Package Sales Table -->
                    <TableView fx:id="tblPackages" prefHeight="500">
                        <columns>
                            <TableColumn fx:id="colPackageName2" text="Package Name" prefWidth="150"/>
                            <TableColumn fx:id="colPackagePrice" text="Price" prefWidth="120"/>
                            <TableColumn fx:id="colPackageSold" text="Quantity Sold" prefWidth="120"/>
                            <TableColumn fx:id="colPackageRevenue" text="Revenue" prefWidth="150"/>
                            <TableColumn fx:id="colPackageAvg" text="Avg/Invoice" prefWidth="120"/>
                            <TableColumn fx:id="colPackageStatus" text="Status" prefWidth="100"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>

            <!-- Tab 4: Payment Report -->
            <Tab text="ðŸ’³ Payments" closable="false">
                <VBox spacing="15" style="-fx-padding: 15;">
                    <HBox spacing="10" alignment="CENTER_RIGHT">
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button fx:id="btnExportPayments" text="ðŸ“¤ Export Excel" 
                                style="-fx-background-color: #4CAF50; -fx-text-fill: white;"/>
                    </HBox>

                    <!-- Payment Summary -->
                    <GridPane hgap="15" vgap="15">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="33" minWidth="200"/>
                            <ColumnConstraints percentWidth="33" minWidth="200"/>
                            <ColumnConstraints percentWidth="34" minWidth="200"/>
                        </columnConstraints>
                        
                        <VBox styleClass="card" spacing="5" style="-fx-padding: 15;" GridPane.columnIndex="0">
                            <Label text="Cash" style="-fx-font-size: 12; -fx-text-fill: #757575;"/>
                            <Label fx:id="lblCashTotal" text="0 VND" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #4CAF50;"/>
                        </VBox>
                        
                        <VBox styleClass="card" spacing="5" style="-fx-padding: 15;" GridPane.columnIndex="1">
                            <Label text="Bank Transfer" style="-fx-font-size: 12; -fx-text-fill: #757575;"/>
                            <Label fx:id="lblBankTotal" text="0 VND" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #2196F3;"/>
                        </VBox>
                        
                        <VBox styleClass="card" spacing="5" style="-fx-padding: 15;" GridPane.columnIndex="2">
                            <Label text="QR Code" style="-fx-font-size: 12; -fx-text-fill: #757575;"/>
                            <Label fx:id="lblQRTotal" text="0 VND" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #FF9800;"/>
                        </VBox>
                    </GridPane>

                    <!-- Payment Details Table -->
                    <TableView fx:id="tblPayments" prefHeight="400">
                        <columns>
                            <TableColumn fx:id="colPaymentId" text="Payment ID" prefWidth="100"/>
                            <TableColumn fx:id="colPaymentDate" text="Payment Date" prefWidth="120"/>
                            <TableColumn fx:id="colPaymentInvoice" text="Invoice #" prefWidth="100"/>
                            <TableColumn fx:id="colPaymentMember" text="Member" prefWidth="150"/>
                            <TableColumn fx:id="colPaymentAmount" text="Amount" prefWidth="120"/>
                            <TableColumn fx:id="colPaymentMethod" text="Method" prefWidth="120"/>
                            <TableColumn fx:id="colPaymentNote" text="Notes" prefWidth="200"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>

        </TabPane>

    </VBox>
</ScrollPane>
